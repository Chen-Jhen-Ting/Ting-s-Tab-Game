<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ting's Tab-Game</title>
    <link rel="stylesheet" href="start.css">
    <link rel="stylesheet" href="about.css">
    <link rel="stylesheet" href="btn.css">
    <link rel="stylesheet" href="control.css">
    <link rel="stylesheet" href="game.css">
    <style>
        .x{
            display: none!important;
        }
    </style>
</head>
<body>
    <div id="btn-back">＜</div>
    <div id="btn-full-screen">口</div>
    <div id="start">
        <div class="wrap">
            <h1>Fake Mikutap</h1>
            <div><span id="btn-start">START</span></div>
            <div><span id="btn-about">ABOUT</span></div>
            <div><P>* Raise the volume and enjoy !</P></div>
            <div>
            <p>SHARE:</p>
                <div>
                    <a href="#"><img class="icon" src="https://aidn.jp/shared/img/sns/twitter_w.png" alt=""></a>
                    <a href="#"><img class="icon" src="https://aidn.jp/shared/img/sns/facebook_w.png" alt=""></a>
                    <a href="#"><img class="icon" src="https://aidn.jp/shared/img/sns/google_w.png" alt=""></a>
                </div>
            </div>
        </div>
    </div>

    <div class="x" id="about">
        <div class="about-background">
            <div class="about-text">
                <div id="about-x">X</div>
                <p>Voiced by <span>Hatsune Miku</span></p>
                <p>Created by <span>Ting  </span>( <span><a href="https://www.facebook.com/profile.php?id=100000133118763">Facebook</a></span> )</p>
                <p>Inspired by <a href="">Patatap</a>, Mimic from <a href="https://aidn.jp/mikutap/">Mikutap</a></p>
                <p>( Wonderful website! )</p>
            </div>
        </div>
    </div>
    
    
    <div class="game-table x" id="game-table">
        <div class="x" id="control-table">
            <div><p>CLICK & DRAG or PRESS ANY KEY!</p></div>
            <div><P class="control-btn" id="feedback-btn">FEEDBACK : <span id="feedback-sign">ON</span></P></div>
            <div><P class="control-btn" id="backtrack-btn">BACKTRACK : <span id="backtrack-sign">ON</span></P></div>
        </div>
            <audio id="game-background-music" src="/tag-game mp3/bc.mp3" controls loop></audio>
            <div class="box" id="box1">  <audio controls src="/tag-game mp3/1.mp3" id="1"  ></audio></div>
            <div class="box" id="box2">  <audio controls src="/tag-game mp3/2.mp3" id="2"  ></audio></div>
            <div class="box" id="box3">  <audio controls src="/tag-game mp3/3.mp3" id="3"  ></audio></div>
            <div class="box" id="box4">  <audio controls src="/tag-game mp3/4.mp3" id="4"  ></audio></div>
            <div class="box" id="box5">  <audio controls src="/tag-game mp3/5.mp3" id="5"  ></audio></div>
            <div class="box" id="box6">  <audio controls src="/tag-game mp3/6.mp3" id="6"  ></audio></div>
            <div class="box" id="box7">  <audio controls src="/tag-game mp3/7.mp3" id="7"  ></audio></div>
            <div class="box" id="box8">  <audio controls src="/tag-game mp3/8.mp3" id="8"  ></audio></div>
            <div class="box" id="box9">  <audio controls src="/tag-game mp3/9.mp3" id="9"  ></audio></div>
            <div class="box" id="box10"><audio controls src="/tag-game mp3/10.mp3" id="10" ></audio></div>
            <div class="box" id="box11"><audio controls src="/tag-game mp3/11.mp3" id="11" ></audio></div>
            <div class="box" id="box12"><audio controls src="/tag-game mp3/12.mp3" id="12" ></audio></div>
            <div class="box" id="box13"><audio controls src="/tag-game mp3/13.mp3" id="13" ></audio></div>
            <div class="box" id="box14"><audio controls src="/tag-game mp3/14.mp3" id="14" ></audio></div>
            <div class="box" id="box15"><audio controls src="/tag-game mp3/15.mp3" id="15" ></audio></div>
            <div class="box" id="box16"><audio controls src="/tag-game mp3/16.mp3" id="16" ></audio></div>
            <div class="box" id="box17"><audio controls src="/tag-game mp3/17.mp3" id="17" ></audio></div>
            <div class="box" id="box18"><audio controls src="/tag-game mp3/18.mp3" id="18" ></audio></div>
            <div class="box" id="box19"><audio controls src="/tag-game mp3/19.mp3" id="19" ></audio></div>
            <div class="box" id="box20"><audio controls src="/tag-game mp3/20.mp3" id="20" ></audio></div>
            <div class="box" id="box21"><audio controls src="/tag-game mp3/21.mp3" id="21" ></audio></div>
            <div class="box" id="box22"><audio controls src="/tag-game mp3/22.mp3" id="22" ></audio></div>
            <div class="box" id="box23"><audio controls src="/tag-game mp3/23.mp3" id="23" ></audio></div>
            <div class="box" id="box24"><audio controls src="/tag-game mp3/24.mp3" id="24" ></audio></div>
            <div class="box" id="box25"><audio controls src="/tag-game mp3/25.mp3" id="25" ></audio></div>
            <div class="box" id="box26"><audio controls src="/tag-game mp3/26.mp3" id="26" ></audio></div>
            <div class="box" id="box27"><audio controls src="/tag-game mp3/27.mp3" id="27" ></audio></div>
            <div class="box" id="box28"><audio controls src="/tag-game mp3/28.mp3" id="28" ></audio></div>
            <div class="box" id="box29"><audio controls src="/tag-game mp3/29.mp3" id="29" ></audio></div>
            <div class="box" id="box30"><audio controls src="/tag-game mp3/30.mp3" id="30" ></audio></div>
            <div class="box" id="box31"><audio controls src="/tag-game mp3/31.mp3" id="31" ></audio></div>
            <div class="box" id="box32"><audio controls src="/tag-game mp3/32.mp3" id="32" ></audio></div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript">
                        // var area
        var full_screen_btn = document.querySelector('#btn-full-screen')
        var back_btn = document.querySelector('#btn-back')
        var start_btn = document.querySelector('#btn-start')
        var start_view = document.querySelector('#start')
        var game_view = document.querySelector('#game-table')
        var bgm = document.querySelector('#game-background-music')
        var about_btn = document.querySelector('#btn-about')
        var about_view = document.querySelector('#about')
        var about_x = document.querySelector('#about-x')
        var control_table = document.querySelector('#control-table')
        var backtrack_btn = document.querySelector('#backtrack-btn')
        var backtrack_sign= document.querySelector('#backtrack-sign')   
        var feedback_btn= document.querySelector('#feedback-btn')
        var feedback_sign= document.querySelector('#feedback-sign')     
        var box_x = (document.body.clientWidth / 8);
        var box_y = (document.body.clientHeight / 4);
        var isDown = false;
        var activeTime = 0;
        var timeToChange = 10;
        var isStart = false
        var doNotThingTime = 0
        var press_effect = true
        var bgm_played = true
                        // var area

                        // full-screen btn
        full_screen_btn.onmousedown = function () { 
            event.stopPropagation()
            if (document.fullscreenElement) { 
                document.exitFullscreen()
            } else { 
                document.documentElement.requestFullscreen() 
            } 
        };                 
                        // full-screen btn
                        
                        //  back btn
        back_btn.addEventListener('mousedown', function(){
            event.stopPropagation()
            bgm.pause();
            start_view.classList.remove('x');
            game_view.classList.add('x');
            control_table.classList.add('x')
            isStart = false
        });                 
                        //  back btn
                        
                        // start btn
        start_btn.addEventListener('mousedown', function(){
            event.stopPropagation()
            isStart = true
            start_view.classList.add('x');
            game_view.classList.remove('x');
            control_table.classList.remove('x')
            bgm.play();
        });
                        // start btn

                        // about btn
        about_btn.addEventListener('mousedown', function(){
            event.stopPropagation()
            about_view.classList.remove('x');
            start_view.classList.add('x');
        });
                        // about btn

                        // about back to start btn
        about_x.addEventListener('mousedown', function(){ 
            event.stopPropagation()
            about_view.classList.add('x');
            start_view.classList.remove('x');
        });
                        // about back to start btn 

                        // game mousedown music
        document.addEventListener('mousedown',function(event){
            event.preventDefault
            if (isStart){
                var number =  Math.floor(event.pageX/ box_x + 1 ) + Math.floor(event.pageY / box_y)*8;
                document.getElementById(String(number)).play();
                if (press_effect){
                    document.getElementById('box'+String(number)).classList.add('box-active'); 
                }
            }
        }); 
                    // game mousedown music            

                    // window resize problem
        window.addEventListener('resize',function(event){
            box_x = (document.body.clientWidth / 8);
            box_y = (document.body.clientHeight / 4);
        }); 
                    // window resize problem

                    // mouse press check    
        document.addEventListener('mousedown',function(){
            isDown = true;
            activeTime = activeTime + 1;
        });
                      
        document.addEventListener('mouseup',function(){
            isDown = false
        });
                    // mouse press check 

                    // mouse up remove box-active class
        document.addEventListener('mouseup',function(event){
            var number =  Math.floor(event.pageX/ box_x + 1 ) + Math.floor(event.pageY / box_y)*8
            document.getElementById('box'+String(number)).classList.remove('box-active');
        });
                    // mouse up remove box-active class

                    // mouseover under mouse pressed
        document.addEventListener('mouseover',function(event){
            if (isDown) {
                activeTime = activeTime + 1;
                doNotThingTime = 0;
                var number =  Math.floor(event.pageX/ box_x + 1 ) + Math.floor(event.pageY / box_y)*8;
                document.getElementById(String(number)).play();
                if (press_effect){
                    document.getElementById('box'+String(number)).classList.add('box-active');
                }
                            // remove class-box-active  from acticed box
                document.getElementById('box'+String(number+1)).classList.remove('box-active');
                document.getElementById('box'+String(number-1)).classList.remove('box-active');
                document.getElementById('box'+String(number+8)).classList.remove('box-active');
                document.getElementById('box'+String(number-8)).classList.remove('box-active'); 
                            // remove class-box-active  from actived box
            }
        });  
                            // mouseover under mouse pressed

                            // game-view background color change
        document.addEventListener('mousedown',function(event){
            if ( isDown & activeTime % timeToChange == 0 ){
                var r = Math.floor( ( Math.random()*100 ) % 256 );
                var g = Math.floor( ( Math.random()*100 ) % 256 );
                var b = Math.floor( ( Math.random()*100 ) % 256 );
                document.getElementById('game-table').style.backgroundColor = 'rgb(' + r + ', ' + g + ', ' + b + ')'
            }               
        })
                            // game-view background color change

                            // do not thing time counter
        document.addEventListener('mousedown',function(){
            if (isStart){
                control_table.classList.add('x')
            }
        });
        function timeCounter(){
            if (isStart){
                doNotThingTime = doNotThingTime +1
                if (doNotThingTime > 2 ){
                control_table.classList.remove('x');
                doNotThingTime = 0;
                }
            }
        };
        setInterval(timeCounter,1000)
                            // do not thing time counter
        
                            // BGM control
        backtrack_btn.addEventListener('mousedown', function(event){
            event.stopPropagation()
            if ( bgm.play() ){
                bgm.pause()
                backtrack_sign.textContent = "OFF"
            }else{
                bgm.play()
                backtrack_sign.textContent = "ON"
            }
        });
        // backtrack_btn.addEventListener('mousedown', function(event){
        //     event.stopPropagation()
        //     if ( bgm_played ){
        //         bgm.pause()
        //         backtrack_sign.textContent = "OFF"
        //         bgm_played = false
        //     }else{
        //         bgm.play()
        //         backtrack_sign.textContent = "ON"
        //         bgm_played = true
        //     }
        // });
                            // BGM control

                            // press effect control
        feedback_btn.addEventListener('mousedown', function(event){
            event.stopPropagation()
            if ( press_effect ){
                press_effect = false
                feedback_sign.textContent = "OFF"
            }else{
                press_effect = true
                feedback_sign.textContent = "ON"
            }
        });
                            // press effect control
    </script>
</body>
</html>